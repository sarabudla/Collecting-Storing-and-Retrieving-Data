---
title: "DA5020.A5.Yogesh.Purushotham"
author: "Yogesh Purushotham"
date: "2023-05-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Question 1:

```{r}

library(httr)
library(XML)
library(tidyverse)
library(RCurl)
library(dplyr)
library(lubridate)

# Load the XML data directly from the URL
url <- "http://www.senate.gov/general/contact_information/senators_cfm.xml"
doc <- xmlParse(rawToChar(GET(url)$content))
senate <- xmlToDataFrame(doc)
senate
# Dimesion of data frame
dim(senate)
```
# Question 2:

```{r}
f_name <-str_extract(senate$first_name, "^[A-Z][a-z]+")
new_senate <-senate %>%
  mutate(first_name = f_name)
details <- data_frame(First_name = new_senate$first_name, Last_name = new_senate$last_name, Party = new_senate$party)
as.data.frame(details)
```


# Question 3:

```{r}
SenatorsByState <- function(x){
    state_senate <- new_senate %>%
    filter(state == x) %>%
    select(state,first_name, last_name, party) %>%
    group_by(state)
  a <- paste("The senators for",(x),"are: ")
  b <- paste(state_senate$first_name, state_senate$last_name, ',', recode(state_senate$party, "D" = "Democratic Party", "R" = "Republican Party"))
  r <- str_c(b, collapse = " and ")
  s <- str_c(a, r)
  return(s)
}
SenatorsByState("MA")

```


# Question 4:

```{r}
# Load csv file
unemployment_senate <- read.delim2 (file = "/Users/yogeshpurushotham/Desktop/NEU/DA5020/Ratio Of Female To Male Youth Unemployment Rate .csv", header=TRUE, sep = ",", skip=4)

# Create country_name tibble
country_name_raw <- tibble(
  Country.Name = unemployment_senate$Country.Name,
  Country.Code = unemployment_senate$Country.Code
)

# Remove duplicate
country_name <- country_name_raw %>%
  distinct()
country_name

# Create indicator_data tibble
year_value <- unemployment_senate %>% 
  pivot_longer(c('X1960':'X2020'), names_to = "Year", values_to = "Value")
indicator_senate_raw = data.frame(unemployment_senate$Country.Code, year_value$Year, year_value$Value)
  
colnames(indicator_senate_raw)[1] = "Country.Code"
colnames(indicator_senate_raw)[2] = "Year"
colnames(indicator_senate_raw)[3] = "Value"

indicator_senate <- as_tibble(indicator_senate_raw)
indicator_senate
```
# Question 5:


```{r}
Continent.Name <- c("North America", "North America", "North America", "North America", "North America", "Asia", "Asia", "Asia", "Asia", "Asia", "Middle East", "Middle East", "Middle East", "Middle East", "Middle East")
Country.Name <- c("United States", "Canada", "Mexico", "Costa Rica", "Panama", "India", "Pakistan", "China", "Sri Lanka", "Bangladesh", "United Arab Emirates", "Iran, Islamic Rep.", "Israel", "Saudi Arabia", "Iraq")
df_Continent <- data.frame(Continent.Name, Country.Name)

df_merged <- df_Continent %>%
  left_join(country_name_raw, by = "Country.Name") %>%
  left_join(indicator_senate, by = "Country.Code")


df_merged %>%
  filter(Year %in% c("X2001", "X2002", "X2003", "X2004", "X2005", "X2006", "X2007", "X2008", "X2009", "X2010", "X2011", "X2012", "X2013", "X2014", "X2015", "X2016", "X2017", "X2018", "X2019", "X2020")) %>%
  ggplot(aes(Year, Value)) +
  geom_line(aes(group = Country.Name, color = Country.Name)) +
  facet_wrap(~Continent.Name, nrow = 3)
```

###Observation:

1. From graph generated above we can observe that Ratio Of Female To Male Youth Unemployment Rate in India and Pakistan seems to be higher in the years 2001 and 2002 while the other countries seem to be lower and they decrease again towards 2020 for the asian countries.

2. From graph generated above we can observe that Ratio Of Female To Male Youth Unemployment Rate was the highest in Saudi Arabia in 2003, United Arab Emirates in 2004, Iran in 2006, Iraq in 2007 and Isreal in 2009 for the Middleastern countries.

3. From graph generated above we can observe that Ratio Of Female To Male Youth Unemployment Rate was the highest for The US in the year 2017, Panama in 2011, Canada and Costa Rica in 2016 for the North American countries.